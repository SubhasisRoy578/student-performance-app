<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Performance Prediction</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { background-color: #f4f6f8; }
        .progress { height: 25px; border-radius: 20px; }
        .progress-bar { font-weight: bold; }
        canvas { margin-top: 15px; }
    </style>
</head>

<body>

<div class="container d-flex justify-content-center align-items-center min-vh-100">
<div class="card shadow-lg p-4" style="width: 480px;">

<h3 class="text-center mb-4">Student Performance Prediction</h3>

<form method="POST">

<div class="mb-3">
<label class="form-label">Study Hours per Day</label>
<input type="number" step="0.1" name="study_hours" class="form-control"
value="{{ form_data.study_hours if form_data }}" required>
</div>

<div class="mb-3">
<label class="form-label">Attendance Percentage (%)</label>
<input type="number" name="attendance" class="form-control"
value="{{ form_data.attendance if form_data }}" required>
</div>

<div class="mb-3">
<label class="form-label">Internal Marks (out of 100)</label>
<input type="number" name="internal_marks" class="form-control"
value="{{ form_data.internal_marks if form_data }}" required>
</div>

<div class="mb-3">
<label class="form-label">Previous Semester GPA (0.0 to 10.0)</label>
<input type="number" step="0.1" name="gpa" class="form-control"
value="{{ form_data.gpa if form_data }}" required>
</div>

<div class="mb-3">
<label class="form-label">Number of Backlogs</label>
<input type="number" name="backlogs" min="0" class="form-control"
value="{{ form_data.backlogs if form_data }}" required>
</div>

<div class="mb-3">
<label class="form-label">Assignment Completion (%)</label>
<input type="number" name="assignments" min="0" max="100" class="form-control"
value="{{ form_data.assignments if form_data }}" required>
</div>

<div class="mb-3">
<label class="form-label">Sleep Hours per Day</label>
<input type="number" step="0.1" name="sleep" class="form-control"
value="{{ form_data.sleep if form_data }}" required>
</div>

<div class="mb-3">
<label class="form-label">Class Participation</label>
<select name="participation" class="form-select" required>
<option value="0" {% if form_data and form_data.participation=='0' %}selected{% endif %}>Low</option>
<option value="1" {% if form_data and form_data.participation=='1' %}selected{% endif %}>Medium</option>
<option value="2" {% if form_data and form_data.participation=='2' %}selected{% endif %}>High</option>
</select>
</div>

<div class="d-flex gap-2">
<button class="btn btn-primary w-100">Predict</button>
<a href="/" class="btn btn-secondary w-100">Reset</a>
</div>

</form>

{% if prediction %}
<hr>

<h5 class="text-center
{% if prediction=='High Performance' %}text-success
{% elif prediction=='Medium Performance' %}text-warning
{% else %}text-danger{% endif %}">
Result: {{ prediction }}
</h5>

<p><strong>Confidence:</strong> {{ confidence }}%</p>
<div class="progress mb-3">
<div class="progress-bar bg-info" style="width: {{ confidence }}%">{{ confidence }}%</div>
</div>

<h6>Performance Factors</h6>
<ul>{% for r in reasons %}<li>{{ r }}</li>{% endfor %}</ul>

<h6>Suggestions for Improvement</h6>
<ul>{% for s in suggestions %}<li>{{ s }}</li>{% endfor %}</ul>

<h6>Score Comparison</h6>
<canvas id="scoreChart"></canvas>

<h6>Attendance vs Performance</h6>
<canvas id="attendanceChart"></canvas>

<h6>Study Hours vs Performance</h6>
<canvas id="studyChart"></canvas>

<h6>GPA vs Performance</h6>
<canvas id="gpaChart"></canvas>

<script>
new Chart(document.getElementById('scoreChart'), {
    type:'bar',
    data:{
        labels:['Obtained Score','Maximum Score'],
        datasets:[{
            label:'Score',
            data:[{{score}},14],
            backgroundColor:['#0d6efd','#ced4da']
        }]
    },
    options:{scales:{y:{beginAtZero:true,max:14}}}
});

new Chart(document.getElementById('attendanceChart'),{
    type:'line',
    data:{
        labels:['Low','Medium','High'],
        datasets:[{
            label:'Performance Score',
            data:[40,65,{{confidence}}],
            tension:0.4
        }]
    }
});

new Chart(document.getElementById('studyChart'),{
    type:'bar',
    data:{
        labels:['2 hrs','4 hrs','6 hrs'],
        datasets:[{
            label:'Performance Score',
            data:[50,70,{{confidence}}]
        }]
    }
});

new Chart(document.getElementById('gpaChart'),{
    type:'line',
    data:{
        labels:['6.0','7.0','8.0','9.0'],
        datasets:[{
            label:'Performance Score',
            data:[55,65,80,{{confidence}}],
            tension:0.4
        }]
    }
});
</script>

{% endif %}

</div>
</div>

</body>
</html>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Performance Prediction</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            background-color: #f4f6f8;
        }
        .progress {
            height: 25px;
            border-radius: 20px;
        }
        .progress-bar {
            font-weight: bold;
        }
    </style>
</head>

<body class="bg-light">

<div class="container d-flex justify-content-center align-items-center min-vh-100">
    <div class="card shadow-lg p-4" style="width: 460px;">

        <h3 class="text-center mb-4">Student Performance Prediction</h3>

        <form method="POST">

            <div class="mb-3">
                <label class="form-label">Study Hours per Day</label>
                <input type="number" step="0.1" name="study_hours" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Attendance Percentage</label>
                <input type="number" name="attendance" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Internal Marks</label>
                <input type="number" name="internal_marks" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Previous Semester GPA</label>
                <input type="number" step="0.1" name="gpa" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Number of Backlogs</label>
                <input type="number" name="backlogs" min="0" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Assignment Completion (%)</label>
                <input type="number" name="assignments" min="0" max="100" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Sleep Hours per Day</label>
                <input type="number" step="0.1" name="sleep" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Class Participation</label>
                <select name="participation" class="form-select" required>
                    <option value="0">Low</option>
                    <option value="1">Medium</option>
                    <option value="2">High</option>
                </select>
            </div>

            <div class="d-flex gap-2 mt-3">
                <button type="submit" class="btn btn-primary w-100">Predict</button>
                <a href="/" class="btn btn-secondary w-100">Reset</a>
            </div>

        </form>

        {% if prediction %}
        <hr>

        <!-- RESULT -->
        <div class="text-center">
            {% if prediction == "Pass" %}
                <h5 class="text-success">Result: {{ prediction }}</h5>
            {% elif prediction == "At Risk" %}
                <h5 class="text-warning">Result: {{ prediction }}</h5>
            {% else %}
                <h5 class="text-danger">Result: {{ prediction }}</h5>
            {% endif %}
        </div>

        <!-- CONFIDENCE BAR -->
        <p class="mt-3 mb-1"><strong>Confidence:</strong> {{ confidence }}%</p>
        <div class="progress mb-3">
            <div class="progress-bar bg-info" role="progressbar"
                 style="width: {{ confidence }}%;">
                {{ confidence }}%
            </div>
        </div>

        <!-- EXPLANATION -->
        <h6>Result Explanation</h6>
        <ul>
            {% for reason in reasons %}
                <li>{{ reason }}</li>
            {% endfor %}
        </ul>

        <!-- CHART -->
        <canvas id="performanceChart" height="200"></canvas>

        <script>
            const ctx = document.getElementById('performanceChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Score', 'Max Score'],
                    datasets: [{
                        label: 'Performance Comparison',
                        data: [{{ score }}, 14],
                        backgroundColor: ['#0d6efd', '#ced4da']
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 14
                        }
                    }
                }
            });
        </script>

        {% endif %}

    </div>
</div>

</body>
</html>
